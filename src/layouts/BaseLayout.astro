---
// src/layouts/BaseLayout.astro
import SEO from "../components/SEO.astro";
import Logo from "../components/Logo.astro";
import "../styles/global.css";

export interface Props {
  title: string;
  description: string;
  canonical?: string;
  image?: string;
  noindex?: boolean;
  structuredData?: object;
}

const props = Astro.props;

const nav = [
  { label: "Znajdź terapeutę", href: "/#find" },
  { label: "Jak to działa", href: "/jak-to-dziala" },
  { label: "O psychoterapii", href: "/#about" },
  { label: "Artykuły", href: "/#articles" },
  { label: "Kontakt", href: "/#contact" },
];

const currentPath = Astro.url.pathname;
---

<!doctype html>
<html lang="pl">
<head>
  <SEO {...props} />
</head>
<body>
  <a href="#main" class="sr-only focus:not-sr-only">Przejdź do treści</a>
  
  <header class="fixed w-full top-0 z-50 bg-white/95 backdrop-blur-md border-b border-gray-100">
    <nav class="max-w-7xl mx-auto px-6 md:px-8 flex justify-between items-center h-20">
      <Logo size="l" />
      
      <ul class="hidden md:flex items-center gap-8">
        {nav.map((item) => (
          <li>
            <a
              href={item.href}
              class={`text-sm transition-colors ${
                currentPath === item.href.split('#')[0]
                  ? "text-orange-600 font-medium"
                  : "text-gray-600 hover:text-gray-900"
              }`}
            >
              {item.label}
            </a>
          </li>
        ))}
        <li>
          <a href="/#find" class="bg-gray-900 text-white px-6 py-3 text-sm font-medium hover:bg-gray-800 transition-colors rounded-full">
            Znajdź terapeutę
          </a>
        </li>
      </ul>
      
      <button class="md:hidden p-2" aria-label="Menu" aria-expanded="false">
        <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M4 6h16M4 12h16m-16 6h16"/>
        </svg>
      </button>
    </nav>
    
    <div id="mobile-menu" class="hidden md:hidden border-t border-gray-100">
      <div class="px-6 py-4 space-y-2">
        {nav.map((item) => (
          <a
            href={item.href}
            class={`block px-4 py-3 text-sm rounded-lg ${
              currentPath === item.href.split('#')[0]
                ? "bg-orange-50 text-orange-600 font-medium"
                : "text-gray-600 hover:bg-gray-50"
            }`}
          >
            {item.label}
          </a>
        ))}
        <a href="/#find" class="block w-full bg-gray-900 text-white px-6 py-3 text-sm font-medium hover:bg-gray-800 rounded-full text-center mt-4">
          Znajdź terapeutę
        </a>
      </div>
    </div>
  </header>
  
  <main id="main"><slot /></main>
  
  <footer class="bg-gray-50 border-t border-gray-100 py-16 px-6 md:px-8">
    <div class="max-w-7xl mx-auto">
      <div class="grid md:grid-cols-4 gap-8 mb-12">
        <div class="md:col-span-2">
          <Logo size="s" class="mb-6" />
          <p class="text-sm text-gray-600 mb-6 max-w-sm">
            Platforma łącząca osoby potrzebujące wsparcia psychologicznego z certyfikowanymi psychoterapeutami.
          </p>
          <div class="flex gap-4">
            {['facebook', 'instagram', 'linkedin'].map(social => (
              <a
                href={`https://${social}.com/profesjonalnapsychoterapia`}
                class="w-10 h-10 bg-white rounded-full flex items-center justify-center text-gray-400 hover:text-gray-600 transition-colors"
                aria-label={social}
              >
                <svg class="w-5 h-5">
                  <use href={`/icons.svg#icon-${social}`}></use>
                </svg>
              </a>
            ))}
          </div>
        </div>
        
        <nav>
          <h3 class="font-medium mb-4">Dla pacjentów</h3>
          <ul class="space-y-3 text-sm text-gray-600">
            {[
              ['Znajdź terapeutę', '/terapeuci'],
              ['Jak to działa', '/jak-to-dziala'],
              ['Cennik', '/cennik'],
              ['FAQ', '/faq']
            ].map(([label, href]) => (
              <li><a href={href} class="hover:text-gray-900">{label}</a></li>
            ))}
          </ul>
        </nav>
        
        <nav>
          <h3 class="font-medium mb-4">Dla terapeutów</h3>
          <ul class="space-y-3 text-sm text-gray-600">
            {[
              ['Dołącz do nas', '/dolacz'],
              ['Jak weryfikujemy', '/weryfikacja'],
              ['Korzyści', '/korzysci'],
              ['Panel terapeuty', '/panel']
            ].map(([label, href]) => (
              <li><a href={href} class="hover:text-gray-900">{label}</a></li>
            ))}
          </ul>
        </nav>
      </div>
      
      <div class="pt-8 border-t border-gray-200 flex flex-col md:flex-row justify-between items-center gap-4">
        <p class="text-sm text-gray-500">© 2024 Profesjonalna-psychoterapia.pl</p>
        <nav class="flex gap-6 text-sm text-gray-500">
          {[
            ['Polityka prywatności', '/polityka-prywatnosci'],
            ['Regulamin', '/regulamin'],
            ['Kontakt', '/kontakt']
          ].map(([label, href]) => (
            <a href={href} class="hover:text-gray-700">{label}</a>
          ))}
        </nav>
      </div>
    </div>
  </footer>
  
  <script>
    // Mobile menu
    const btn = document.querySelector('[aria-label="Menu"]');
    const menu = document.getElementById('mobile-menu');
    btn?.addEventListener('click', () => {
      const expanded = btn.getAttribute('aria-expanded') === 'true';
      btn.setAttribute('aria-expanded', (!expanded).toString());
      menu?.classList.toggle('hidden');
    });
    
    // Header shadow
    let ticking = false;
    function updateHeader() {
      document.querySelector('header')?.classList.toggle('shadow-sm', window.scrollY > 10);
      ticking = false;
    }
    window.addEventListener('scroll', () => {
      if (!ticking) {
        requestAnimationFrame(updateHeader);
        ticking = true;
      }
    });
    
    // Smooth scroll
    document.querySelectorAll('a[href^="#"]').forEach(a => {
      a.addEventListener('click', e => {
        e.preventDefault();
        const target = document.querySelector(a.getAttribute('href'));
        if (target) {
          window.scrollTo({
            top: target.offsetTop - 80,
            behavior: 'smooth'
          });
        }
      });
    });
  </script>
</body>
</html>